<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Snake Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
  body {
    margin: 0;
    background: #111;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    overflow: hidden;
  }
  h1 { margin: 10px 0; }
  #score { margin-bottom: 10px; }
  canvas {
    background: #000;
    display: block;
    margin: auto;
    touch-action: none;
  }
</style>
</head>

<body>
<h1>üêç Snake Game</h1>
<div id="score">Score: 0</div>
<canvas id="game" width="300" height="300"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const box = 15;
let score = 0;

let snake = [{ x: 150, y: 150 }];
let direction = "RIGHT";

let food = randomFood();

function randomFood() {
  return {
    x: Math.floor(Math.random() * (canvas.width / box)) * box,
    y: Math.floor(Math.random() * (canvas.height / box)) * box
  };
}

function draw() {
  ctx.fillStyle = "black";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Food
  ctx.fillStyle = "red";
  ctx.fillRect(food.x, food.y, box, box);

  // Snake
  ctx.fillStyle = "lime";
  snake.forEach(s => ctx.fillRect(s.x, s.y, box, box));

  let head = { ...snake[0] };

  if (direction === "LEFT") head.x -= box;
  if (direction === "RIGHT") head.x += box;
  if (direction === "UP") head.y -= box;
  if (direction === "DOWN") head.y += box;

  // Eat food
  if (head.x === food.x && head.y === food.y) {
    score++;
    document.getElementById("score").innerText = "Score: " + score;
    navigator.vibrate?.(50);
    food = randomFood();
  } else {
    snake.pop();
  }

  // Collision
  if (
    head.x < 0 || head.y < 0 ||
    head.x >= canvas.width || head.y >= canvas.height ||
    snake.some(s => s.x === head.x && s.y === head.y)
  ) {
    alert("Game Over! Score: " + score);
    location.reload();
  }

  snake.unshift(head);
}

// Keyboard controls
document.addEventListener("keydown", e => {
  if (e.key === "ArrowLeft" && direction !== "RIGHT") direction = "LEFT";
  if (e.key === "ArrowRight" && direction !== "LEFT") direction = "RIGHT";
  if (e.key === "ArrowUp" && direction !== "DOWN") direction = "UP";
  if (e.key === "ArrowDown" && direction !== "UP") direction = "DOWN";
});

// ‚úÖ SWIPE CONTROLS (FIXED)
let startX = 0;
let startY = 0;

canvas.addEventListener("touchstart", e => {
  const t = e.touches[0];
  startX = t.clientX;
  startY = t.clientY;
}, { passive: true });

canvas.addEventListener("touchend", e => {
  const t = e.changedTouches[0];
  let diffX = t.clientX - startX;
  let diffY = t.clientY - startY;

  if (Math.abs(diffX) > Math.abs(diffY)) {
    if (diffX > 30 && direction !== "LEFT") direction = "RIGHT";
    else if (diffX < -30 && direction !== "RIGHT") direction = "LEFT";
  } else {
    if (diffY > 30 && direction !== "UP") direction = "DOWN";
    else if (diffY < -30 && direction !== "DOWN") direction = "UP";
  }
}, { passive: true });

setInterval(draw, 140);
</script>

</body>
</html>
